{"remainingRequest":"/Users/zzz/Desktop/mac/unit/mountain/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js??vue-loader-options!/Users/zzz/Desktop/mac/unit/mountain/src/views/module.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zzz/Desktop/mac/unit/mountain/src/views/module.vue","mtime":1562224606578},{"path":"/Users/zzz/Desktop/mac/unit/mountain/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zzz/Desktop/mac/unit/mountain/node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zzz/Desktop/mac/unit/mountain/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zzz/Desktop/mac/unit/mountain/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { qiniutoken } from '../api'\nimport moment from 'moment'\nexport default {\n  data () {\n    return {\n      fileList: {\n        articles: []\n      },\n      qiniu: { //  七牛上传\n        token: '',\n        key: '',\n        uploadUrl: '', //  上传地址前缀\n      },\n      form: {\n        imglist: []\n      }\n    }\n  },\n  mounted() {\n    this.getqiniutoken()\n  },\n  methods: {\n\n    getFile (e) {\n      console.log(e)\n        let _this = this\n        var files = e.target.files[0]\n        console.log(files)\n        if (!e || !window.FileReader) return  // 看支持不支持FileReader\n        let reader = new FileReader()\n        let res = reader.readAsDataURL(files) // 这里是最关键的一步，转换就在这里\n        reader.onloadend = function () {\n          console.log(this.result)\n          _this.src = this.result\n        }\n      }\n\n    ,  \n    getqiniutoken () {\n      let para = {\n        bucket: 'huaxiaohong'\n      }\n      qiniutoken(para).then(res => {\n        console.log(res)\n        let { code, data, msg } = res.data\n        if (code === 200) {\n          this.qiniu.token = data.token\n          this.qiniu.uploadUrl = data.url\n          console.log(this.qiniu)\n        } else {\n          this.$message(msg)\n        }\n      })\n    },\n    submitUpload() {\n      this.$refs.upload.submit();\n    },\n    handleBeforeUpload (file, type) { //  上传之前\n      this.qiniu.key = ``+ type +`${moment().format('YYYYMMDDHHmmSSS')}${Number.parseInt(Math.random() * 1000, 10)}.${file.type.split('/')[1]}`\n    },\n    handleOnSuccess (response, file, fileList, type) { //  上传成功之后\n      let url = this.qiniu.uploadUrl + '/' + response.key\n      this.form[type] =  url\n    \n      // this.fileList[type].push({ //  显示文件\n      //   name: response.key,\n      //   url: url\n      // })\n      console.log(this.form)\n    },\n    handleOnRemove (file, fileList, type) { //  删除\n      // this.fileList[type] = []\n      console.log(file, fileList)\n    },\n  },\n}\n",{"version":3,"sources":["module.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"module.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div>\n    <el-upload\n      class=\"upload-demo\"\n      :data=\"qiniu\"\n      ref=\"upload\"\n      action=\"https://upload-z2.qiniup.com\"\n      :show-file-list=\"true\"\n      :multiple=\"false\"\n      :file-list=\"fileList.articles\"\n      :auto-upload=\"false\"\n      :before-upload=\"(file) => {return handleBeforeUpload(file, 'articles')}\"\n      :on-success=\"(response, file, fileList) => { return handleOnSuccess(response, file, fileList, 'articles') }\"\n      :on-remove=\"(file, fileList) => { return handleOnRemove(file, fileList, 'articles') }\"\n    >\n    <el-button size=\"small\" type=\"primary\">点击上传</el-button>\n    </el-upload>\n    <el-button style=\"margin-left: 10px;\" size=\"small\" type=\"success\" @click=\"submitUpload\">上传到服务器</el-button>\n\n\n    <div>\n\n      <input type=\"file\" @change=\"getFile\" ref=\"file\" id=\"file\">\n\n    </div>\n  </div>\n</template>\n\n<script>\nimport { qiniutoken } from '../api'\nimport moment from 'moment'\nexport default {\n  data () {\n    return {\n      fileList: {\n        articles: []\n      },\n      qiniu: { //  七牛上传\n        token: '',\n        key: '',\n        uploadUrl: '', //  上传地址前缀\n      },\n      form: {\n        imglist: []\n      }\n    }\n  },\n  mounted() {\n    this.getqiniutoken()\n  },\n  methods: {\n\n    getFile (e) {\n      console.log(e)\n        let _this = this\n        var files = e.target.files[0]\n        console.log(files)\n        if (!e || !window.FileReader) return  // 看支持不支持FileReader\n        let reader = new FileReader()\n        let res = reader.readAsDataURL(files) // 这里是最关键的一步，转换就在这里\n        reader.onloadend = function () {\n          console.log(this.result)\n          _this.src = this.result\n        }\n      }\n\n    ,  \n    getqiniutoken () {\n      let para = {\n        bucket: 'huaxiaohong'\n      }\n      qiniutoken(para).then(res => {\n        console.log(res)\n        let { code, data, msg } = res.data\n        if (code === 200) {\n          this.qiniu.token = data.token\n          this.qiniu.uploadUrl = data.url\n          console.log(this.qiniu)\n        } else {\n          this.$message(msg)\n        }\n      })\n    },\n    submitUpload() {\n      this.$refs.upload.submit();\n    },\n    handleBeforeUpload (file, type) { //  上传之前\n      this.qiniu.key = ``+ type +`${moment().format('YYYYMMDDHHmmSSS')}${Number.parseInt(Math.random() * 1000, 10)}.${file.type.split('/')[1]}`\n    },\n    handleOnSuccess (response, file, fileList, type) { //  上传成功之后\n      let url = this.qiniu.uploadUrl + '/' + response.key\n      this.form[type] =  url\n    \n      // this.fileList[type].push({ //  显示文件\n      //   name: response.key,\n      //   url: url\n      // })\n      console.log(this.form)\n    },\n    handleOnRemove (file, fileList, type) { //  删除\n      // this.fileList[type] = []\n      console.log(file, fileList)\n    },\n  },\n}\n</script>\n\n<style>\n\n</style>\n"]}]}