{"remainingRequest":"/Users/zzz/Desktop/mac/unit/mountain/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js??vue-loader-options!/Users/zzz/Desktop/mac/unit/mountain/src/views/article.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zzz/Desktop/mac/unit/mountain/src/views/article.vue","mtime":1562061627511},{"path":"/Users/zzz/Desktop/mac/unit/mountain/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zzz/Desktop/mac/unit/mountain/node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zzz/Desktop/mac/unit/mountain/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zzz/Desktop/mac/unit/mountain/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport utils from '../utils/index'\nimport { articlesadd, articleslist, articlesedit, articlesdelete } from '../api'\nexport default {\n  name: '',\n  data () {\n    return {\n      editorOption: {\n        // some quill options\n      },\n      show: '', //  默认显示列表\n      list: { //  用户信息\n        data: [], //  数据\n        total: 0 //  总数\n      },\n      para: { //  查询条件\n        pageIndex: 1,\n        pageSize: 10,\n      },\n      form: {\n        title: '',\n        content: ''\n      }\n    }\n  },\n  created() {\n    \n  },\n  mounted() {\n    this.show = 'list'\n    this.getarticleslist()\n  },\n  methods: {\n    onEditorBlur (quill) {\n      console.log('editor blur!', quill)\n    },\n    onEditorFocus (quill) {\n      console.log('editor focus!', quill)\n    },\n    onEditorReady (quill) {\n      console.log('editor ready!', quill)\n      \n    },\n    getarticleslist () { //  查询列表\n      articleslist(this.para).then(res => {\n        console.log(res)\n        let { code, msg, data, total } = res.data\n        if (code !== 200) {\n          this.$message.error(msg)\n        } else {\n          this.list.data = data\n          this.list.total = total\n        }\n      })\n    },\n    handleSet (obj, row) { //  根据不同状态处理对应事件\n      console.log(obj, row)\n      switch (obj) {\n        case 'add':\n          this.form = {}\n          this.show = 'add'\n          break\n        case 'back':\n          this.show = 'list'\n          break\n        case 'edit':\n          this.form = row\n          this.show = 'edit'\n          break\n        case 'delete':\n          this.show = 'list'\n          this.$confirm('此操作将删除该数据是否继续?', '提示', {\n            confirmButtonText: '继续',\n            cancelButtonText: '取消',\n            type: 'danger'\n          }).then(() => {\n            this.form._id = row._id\n            let para = new URLSearchParams(this.form)\n            articlesdelete(para).then(res => {\n              let { code, msg } = res\n              if (code === 200) {\n                this.$message.success(msg)\n                this.getarticleslist()\n              } else {\n                this.$message.error(msg)\n              }\n            })\n          }).catch(() => {\n            this.$message.info('已取消')\n          })\n          break\n      }\n    },\n    handleSubmit () { //  发布文章\n      if (this.form.title === '' || !this.form.title) {\n        this.$message.error('标题不能为空')\n      } else {\n        this.form.author = sessionStorage.getItem('user')\n        this.form.uid = sessionStorage.getItem('uid')\n        this.form.date = utils.formatterTime(new Date())\n        console.log(this.form)\n        let para = new URLSearchParams(this.form)\n        let a\n        if (this.show === 'add') {\n          a = articlesadd(para)\n        } else {\n          a = articlesedit(para)\n        }\n        a.then(res => {\n          console.log(res)\n          let { code, msg } = res\n          if (code === 200) {\n            this.getarticleslist()\n            this.show = 'list'\n            this.$message.success(msg)\n          } else {\n            this.$message.error(msg)\n          }\n        })\n      }\n    }\n  },\n  computed: {\n    editor() {\n      console.log(1)\n      return this.$refs.myQuillEditor.quill\n    }\n  },\n}\n",{"version":3,"sources":["article.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA4EA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;;AAEA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA;AACA","file":"article.vue","sourceRoot":"src/views","sourcesContent":["<template>\n  <div id=\"articles\">\n    <template v-if=\"show === 'list'\">\n      <div class=\"txtright marginbtm30\">\n         <el-button type=\"info\" @click=\"handleSet('add', {})\">发布文章</el-button>\n      </div>\n      <el-table\n        :data=\"list.data\"\n        style=\"width: 100%\">\n\n         <el-table-column label=\"标题\">\n          <template slot-scope=\"scope\">{{ scope.row.title }}</template>\n        </el-table-column>\n\n        <el-table-column label=\"作者\">\n          <template slot-scope=\"scope\">{{ scope.row.author }}</template>\n        </el-table-column>\n\n        <el-table-column label=\"日期\">\n          <template slot-scope=\"scope\">{{ scope.row.date }}</template>\n        </el-table-column>\n\n        <el-table-column label=\"喜欢\">\n          <template slot-scope=\"scope\">{{ scope.row.likes }}</template>\n        </el-table-column>\n\n        <el-table-column label=\"评分\">\n          <template slot-scope=\"scope\">{{ scope.row.score }}</template>\n        </el-table-column>\n\n        <el-table-column label=\"操作\" min-width=\"90\">\n          <template slot-scope=\"scope\">\n            <el-button\n              size=\"mini\"\n              type=\"primary\"\n              @click=\"handleSet('edit', scope.row)\">编辑</el-button>\n            <el-button\n              size=\"mini\"\n              type=\"danger\"\n              @click=\"handleSet('delete', scope.row)\">删除</el-button>\n          </template>\n        </el-table-column>\n      </el-table>\n      <div class=\"txtcenter\">\n        <el-pagination\n          background\n          layout=\"total, prev, pager, next\"\n          @current-change=\"(value) => {return handleSearch('pagination', value)}\"\n          :current-page=\"para.pageIndex\"\n          :total=\"list.total\">\n        </el-pagination>\n      </div>\n    </template>\n\n    \n    <template v-if=\"show !== 'list'\">\n      <div class=\"articles__btn\">\n        <el-button type=\"info\" @click=\"handleSet('back', null)\" >返回</el-button>\n        <el-button type=\"success\" @click=\"handleSubmit\" >发布</el-button>\n      </div>\n      <div class=\"articles__title\">\n        <el-input ref=\"myinput\" placeholder=\"请输入标题\" v-model=\"form.title \" clearable></el-input>\n      </div>\n      <quill-editor \n        v-model=\"form.content\"\n        ref=\"myQuillEditor\"\n        :options=\"editorOption\"\n        @blur=\"onEditorBlur($event)\"\n        @focus=\"onEditorFocus($event)\"\n        @ready=\"onEditorReady($event)\">\n      </quill-editor>\n    </template>\n  </div>\n</template>\n\n<script>\nimport utils from '../utils/index'\nimport { articlesadd, articleslist, articlesedit, articlesdelete } from '../api'\nexport default {\n  name: '',\n  data () {\n    return {\n      editorOption: {\n        // some quill options\n      },\n      show: '', //  默认显示列表\n      list: { //  用户信息\n        data: [], //  数据\n        total: 0 //  总数\n      },\n      para: { //  查询条件\n        pageIndex: 1,\n        pageSize: 10,\n      },\n      form: {\n        title: '',\n        content: ''\n      }\n    }\n  },\n  created() {\n    \n  },\n  mounted() {\n    this.show = 'list'\n    this.getarticleslist()\n  },\n  methods: {\n    onEditorBlur (quill) {\n      console.log('editor blur!', quill)\n    },\n    onEditorFocus (quill) {\n      console.log('editor focus!', quill)\n    },\n    onEditorReady (quill) {\n      console.log('editor ready!', quill)\n      \n    },\n    getarticleslist () { //  查询列表\n      articleslist(this.para).then(res => {\n        console.log(res)\n        let { code, msg, data, total } = res.data\n        if (code !== 200) {\n          this.$message.error(msg)\n        } else {\n          this.list.data = data\n          this.list.total = total\n        }\n      })\n    },\n    handleSet (obj, row) { //  根据不同状态处理对应事件\n      console.log(obj, row)\n      switch (obj) {\n        case 'add':\n          this.form = {}\n          this.show = 'add'\n          break\n        case 'back':\n          this.show = 'list'\n          break\n        case 'edit':\n          this.form = row\n          this.show = 'edit'\n          break\n        case 'delete':\n          this.show = 'list'\n          this.$confirm('此操作将删除该数据是否继续?', '提示', {\n            confirmButtonText: '继续',\n            cancelButtonText: '取消',\n            type: 'danger'\n          }).then(() => {\n            this.form._id = row._id\n            let para = new URLSearchParams(this.form)\n            articlesdelete(para).then(res => {\n              let { code, msg } = res\n              if (code === 200) {\n                this.$message.success(msg)\n                this.getarticleslist()\n              } else {\n                this.$message.error(msg)\n              }\n            })\n          }).catch(() => {\n            this.$message.info('已取消')\n          })\n          break\n      }\n    },\n    handleSubmit () { //  发布文章\n      if (this.form.title === '' || !this.form.title) {\n        this.$message.error('标题不能为空')\n      } else {\n        this.form.author = sessionStorage.getItem('user')\n        this.form.uid = sessionStorage.getItem('uid')\n        this.form.date = utils.formatterTime(new Date())\n        console.log(this.form)\n        let para = new URLSearchParams(this.form)\n        let a\n        if (this.show === 'add') {\n          a = articlesadd(para)\n        } else {\n          a = articlesedit(para)\n        }\n        a.then(res => {\n          console.log(res)\n          let { code, msg } = res\n          if (code === 200) {\n            this.getarticleslist()\n            this.show = 'list'\n            this.$message.success(msg)\n          } else {\n            this.$message.error(msg)\n          }\n        })\n      }\n    }\n  },\n  computed: {\n    editor() {\n      console.log(1)\n      return this.$refs.myQuillEditor.quill\n    }\n  },\n}\n</script>\n<style lang=\"stylus\">\n#articles {\n  .articles__btn {\n    text-align right \n    margin-bottom 20px\n  }\n  .articles__title {\n    margin 20px 0\n    font-size 20px\n  }\n  .ql-container {\n    height 800px\n  }\n}\n</style>\n\n"]}]}