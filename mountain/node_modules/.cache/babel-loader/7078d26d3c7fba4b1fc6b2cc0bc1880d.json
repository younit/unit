{"remainingRequest":"/Users/zzz/Desktop/mac/unit/mountain/node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js!/Users/zzz/Desktop/mac/unit/mountain/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js??ref--0-0!/Users/zzz/Desktop/mac/unit/mountain/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js??vue-loader-options!/Users/zzz/Desktop/mac/unit/mountain/src/views/module.vue?vue&type=script&lang=js&","dependencies":[{"path":"/Users/zzz/Desktop/mac/unit/mountain/src/views/module.vue","mtime":1562224574653},{"path":"/Users/zzz/Desktop/mac/unit/mountain/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zzz/Desktop/mac/unit/mountain/node_modules/_babel-loader@8.0.6@babel-loader/lib/index.js","mtime":499162500000},{"path":"/Users/zzz/Desktop/mac/unit/mountain/node_modules/_cache-loader@2.0.1@cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/Users/zzz/Desktop/mac/unit/mountain/node_modules/_vue-loader@15.7.0@vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/es6.regexp.split\";\nimport \"core-js/modules/es6.number.constructor\";\nimport \"core-js/modules/es6.number.parse-int\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { qiniutoken } from \"../api\";\nimport moment from 'moment';\nexport default {\n  data: function data() {\n    return {\n      fileList: {\n        articles: []\n      },\n      qiniu: {\n        //  七牛上传\n        token: '',\n        key: '',\n        uploadUrl: '' //  上传地址前缀\n\n      },\n      form: {\n        imglist: []\n      }\n    };\n  },\n  mounted: function mounted() {\n    this.getqiniutoken();\n  },\n  methods: {\n    getFile: function getFile(e) {\n      console.log(e);\n\n      var _this = this;\n\n      var files = e.target.files[0];\n      console.log(files);\n      if (!e || !window.FileReader) return; // 看支持不支持FileReader\n\n      var reader = new FileReader();\n      var res = reader.readAsDataURL(files); // 这里是最关键的一步，转换就在这里\n\n      console.log(res); // reader.onloadend = function () {\n      //   _this.src = this.result\n      // }\n    },\n    getqiniutoken: function getqiniutoken() {\n      var _this2 = this;\n\n      var para = {\n        bucket: 'huaxiaohong'\n      };\n      qiniutoken(para).then(function (res) {\n        console.log(res);\n        var _res$data = res.data,\n            code = _res$data.code,\n            data = _res$data.data,\n            msg = _res$data.msg;\n\n        if (code === 200) {\n          _this2.qiniu.token = data.token;\n          _this2.qiniu.uploadUrl = data.url;\n          console.log(_this2.qiniu);\n        } else {\n          _this2.$message(msg);\n        }\n      });\n    },\n    submitUpload: function submitUpload() {\n      this.$refs.upload.submit();\n    },\n    handleBeforeUpload: function handleBeforeUpload(file, type) {\n      //  上传之前\n      this.qiniu.key = \"\" + type + \"\".concat(moment().format('YYYYMMDDHHmmSSS')).concat(Number.parseInt(Math.random() * 1000, 10), \".\").concat(file.type.split('/')[1]);\n    },\n    handleOnSuccess: function handleOnSuccess(response, file, fileList, type) {\n      //  上传成功之后\n      var url = this.qiniu.uploadUrl + '/' + response.key;\n      this.form[type] = url; // this.fileList[type].push({ //  显示文件\n      //   name: response.key,\n      //   url: url\n      // })\n\n      console.log(this.form);\n    },\n    handleOnRemove: function handleOnRemove(file, fileList, type) {\n      //  删除\n      // this.fileList[type] = []\n      console.log(file, fileList);\n    }\n  }\n};",{"version":3,"sources":["module.vue"],"names":[],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AA6BA,SAAA,UAAA;AACA,OAAA,MAAA,MAAA,QAAA;AACA,eAAA;AACA,EAAA,IADA,kBACA;AACA,WAAA;AACA,MAAA,QAAA,EAAA;AACA,QAAA,QAAA,EAAA;AADA,OADA;AAIA,MAAA,KAAA,EAAA;AAAA;AACA,QAAA,KAAA,EAAA,EADA;AAEA,QAAA,GAAA,EAAA,EAFA;AAGA,QAAA,SAAA,EAAA,EAHA,CAGA;;AAHA,OAJA;AASA,MAAA,IAAA,EAAA;AACA,QAAA,OAAA,EAAA;AADA;AATA,KAAA;AAaA,GAfA;AAgBA,EAAA,OAhBA,qBAgBA;AACA,SAAA,aAAA;AACA,GAlBA;AAmBA,EAAA,OAAA,EAAA;AAEA,IAAA,OAFA,mBAEA,CAFA,EAEA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,CAAA;;AACA,UAAA,KAAA,GAAA,IAAA;;AACA,UAAA,KAAA,GAAA,CAAA,CAAA,MAAA,CAAA,KAAA,CAAA,CAAA,CAAA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,KAAA;AACA,UAAA,CAAA,CAAA,IAAA,CAAA,MAAA,CAAA,UAAA,EAAA,OALA,CAKA;;AACA,UAAA,MAAA,GAAA,IAAA,UAAA,EAAA;AACA,UAAA,GAAA,GAAA,MAAA,CAAA,aAAA,CAAA,KAAA,CAAA,CAPA,CAOA;;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,GAAA,EARA,CASA;AACA;AACA;AACA,KAdA;AAiBA,IAAA,aAjBA,2BAiBA;AAAA;;AACA,UAAA,IAAA,GAAA;AACA,QAAA,MAAA,EAAA;AADA,OAAA;AAGA,MAAA,UAAA,CAAA,IAAA,CAAA,CAAA,IAAA,CAAA,UAAA,GAAA,EAAA;AACA,QAAA,OAAA,CAAA,GAAA,CAAA,GAAA;AADA,wBAEA,GAAA,CAAA,IAFA;AAAA,YAEA,IAFA,aAEA,IAFA;AAAA,YAEA,IAFA,aAEA,IAFA;AAAA,YAEA,GAFA,aAEA,GAFA;;AAGA,YAAA,IAAA,KAAA,GAAA,EAAA;AACA,UAAA,MAAA,CAAA,KAAA,CAAA,KAAA,GAAA,IAAA,CAAA,KAAA;AACA,UAAA,MAAA,CAAA,KAAA,CAAA,SAAA,GAAA,IAAA,CAAA,GAAA;AACA,UAAA,OAAA,CAAA,GAAA,CAAA,MAAA,CAAA,KAAA;AACA,SAJA,MAIA;AACA,UAAA,MAAA,CAAA,QAAA,CAAA,GAAA;AACA;AACA,OAVA;AAWA,KAhCA;AAiCA,IAAA,YAjCA,0BAiCA;AACA,WAAA,KAAA,CAAA,MAAA,CAAA,MAAA;AACA,KAnCA;AAoCA,IAAA,kBApCA,8BAoCA,IApCA,EAoCA,IApCA,EAoCA;AAAA;AACA,WAAA,KAAA,CAAA,GAAA,GAAA,KAAA,IAAA,aAAA,MAAA,GAAA,MAAA,CAAA,iBAAA,CAAA,SAAA,MAAA,CAAA,QAAA,CAAA,IAAA,CAAA,MAAA,KAAA,IAAA,EAAA,EAAA,CAAA,cAAA,IAAA,CAAA,IAAA,CAAA,KAAA,CAAA,GAAA,EAAA,CAAA,CAAA,CAAA;AACA,KAtCA;AAuCA,IAAA,eAvCA,2BAuCA,QAvCA,EAuCA,IAvCA,EAuCA,QAvCA,EAuCA,IAvCA,EAuCA;AAAA;AACA,UAAA,GAAA,GAAA,KAAA,KAAA,CAAA,SAAA,GAAA,GAAA,GAAA,QAAA,CAAA,GAAA;AACA,WAAA,IAAA,CAAA,IAAA,IAAA,GAAA,CAFA,CAIA;AACA;AACA;AACA;;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,KAAA,IAAA;AACA,KAhDA;AAiDA,IAAA,cAjDA,0BAiDA,IAjDA,EAiDA,QAjDA,EAiDA,IAjDA,EAiDA;AAAA;AACA;AACA,MAAA,OAAA,CAAA,GAAA,CAAA,IAAA,EAAA,QAAA;AACA;AApDA;AAnBA,CAAA","sourcesContent":["<template>\n  <div>\n    <el-upload\n      class=\"upload-demo\"\n      :data=\"qiniu\"\n      ref=\"upload\"\n      action=\"https://upload-z2.qiniup.com\"\n      :show-file-list=\"true\"\n      :multiple=\"false\"\n      :file-list=\"fileList.articles\"\n      :auto-upload=\"false\"\n      :before-upload=\"(file) => {return handleBeforeUpload(file, 'articles')}\"\n      :on-success=\"(response, file, fileList) => { return handleOnSuccess(response, file, fileList, 'articles') }\"\n      :on-remove=\"(file, fileList) => { return handleOnRemove(file, fileList, 'articles') }\"\n    >\n    <el-button size=\"small\" type=\"primary\">点击上传</el-button>\n    </el-upload>\n    <el-button style=\"margin-left: 10px;\" size=\"small\" type=\"success\" @click=\"submitUpload\">上传到服务器</el-button>\n\n\n    <div>\n\n      <input type=\"file\" @change=\"getFile\" ref=\"file\" id=\"file\">\n\n    </div>\n  </div>\n</template>\n\n<script>\nimport { qiniutoken } from '../api'\nimport moment from 'moment'\nexport default {\n  data () {\n    return {\n      fileList: {\n        articles: []\n      },\n      qiniu: { //  七牛上传\n        token: '',\n        key: '',\n        uploadUrl: '', //  上传地址前缀\n      },\n      form: {\n        imglist: []\n      }\n    }\n  },\n  mounted() {\n    this.getqiniutoken()\n  },\n  methods: {\n\n    getFile (e) {\n      console.log(e)\n        let _this = this\n        var files = e.target.files[0]\n        console.log(files)\n        if (!e || !window.FileReader) return  // 看支持不支持FileReader\n        let reader = new FileReader()\n        let res = reader.readAsDataURL(files) // 这里是最关键的一步，转换就在这里\n        console.log(res)\n        // reader.onloadend = function () {\n        //   _this.src = this.result\n        // }\n      }\n\n    ,  \n    getqiniutoken () {\n      let para = {\n        bucket: 'huaxiaohong'\n      }\n      qiniutoken(para).then(res => {\n        console.log(res)\n        let { code, data, msg } = res.data\n        if (code === 200) {\n          this.qiniu.token = data.token\n          this.qiniu.uploadUrl = data.url\n          console.log(this.qiniu)\n        } else {\n          this.$message(msg)\n        }\n      })\n    },\n    submitUpload() {\n      this.$refs.upload.submit();\n    },\n    handleBeforeUpload (file, type) { //  上传之前\n      this.qiniu.key = ``+ type +`${moment().format('YYYYMMDDHHmmSSS')}${Number.parseInt(Math.random() * 1000, 10)}.${file.type.split('/')[1]}`\n    },\n    handleOnSuccess (response, file, fileList, type) { //  上传成功之后\n      let url = this.qiniu.uploadUrl + '/' + response.key\n      this.form[type] =  url\n    \n      // this.fileList[type].push({ //  显示文件\n      //   name: response.key,\n      //   url: url\n      // })\n      console.log(this.form)\n    },\n    handleOnRemove (file, fileList, type) { //  删除\n      // this.fileList[type] = []\n      console.log(file, fileList)\n    },\n  },\n}\n</script>\n\n<style>\n\n</style>\n"],"sourceRoot":"src/views"}]}